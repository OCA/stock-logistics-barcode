<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="view_stock_barcodes_todo_kanban" model="ir.ui.view">
        <field name="name">stock.barcodes.todo.kanban</field>
        <field name="model">wiz.stock.barcodes.read.todo</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="picking_code" />
                <field name="location_id" />
                <field name="location_name" />
                <field name="location_dest_id" />
                <field name="location_dest_name" />
                <field name="product_id" />
                <field name="lot_id" />
                <field name="uom_id" />
                <field name="package_id" />
                <field name="result_package_id" />
                <field name="package_product_qty" />
                <field name="product_uom_qty" />
                <field name="qty_done" />
                <field name="line_ids" invisible="1" />
                <field name="state" />
                <templates>
                    <t t-name="kanban-box">
                        <div
                            t-attf-class="oe_kanban_content "
                            style="background-color: #FFF8DC;"
                        >
                            <div class="row">
                                <div class="col">
                                    <span
                                        class="fa fa-map-marker"
                                        title="Location name"
                                    />
                                    <strong>
                                        <span
                                            attrs="{'invisible': [('picking_code', '!=', 'incoming')]}"
                                        >
                                            <field name="location_dest_name" />
                                        </span>
                                        <span
                                            attrs="{'invisible': [('picking_code', '!=', 'internal')]}"
                                        >
                                            <field name="location_name" /> \u21E8 <field
                                                name="location_dest_name"
                                            />
                                        </span>
                                        <span
                                            attrs="{'invisible': [('picking_code', '!=', 'outgoing')]}"
                                        >
                                            <field name="location_name" />
                                        </span>
                                    </strong>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <strong>
                                        <field name="product_id" />
                                    </strong>
                                </div>
                            </div>
                            <t
                                t-if="record.lot_id or record.package_id or record.result_package_id"
                            >
                                <table>
                                    <tr>
                                        <td>
                                            <span>
                                                <span
                                                    class="fa fa-tags"
                                                    title="Lot S/N"
                                                />
                                                <field name="lot_id" />
                                            </span>
                                        </td>
                                        <td class="text-right">
                                            <span class="fa fa-dropbox" />
                                            <span>
                                                <field name="package_id" />
                                                <t t-if="record.package_id">(<span
                                                        t-esc="record.package_product_qty.value"
                                                    /> <t
                                                        t-esc="record.uom_id.value.slice(0,3)"
                                                    />)</t>
                                            </span>
                                            <span>
                                                <field name="result_package_id" />
                                            </span>
                                        </td>
                                    </tr>
                                </table>
                            </t>
                            <div class="row">
                                <div class="col-12">
                                    <span>
                                        <span class="font-weight-bold">
                                            <t t-esc="record.qty_done.value" />
                                        </span> / <t
                                            t-esc="record.product_uom_qty.value"
                                        /> <t t-esc="record.uom_id.value.slice(0,3)" />
                                    </span>
                                </div>
                            </div>
                            <div name="action" class="row">
                                <div class="col-3">
                                    <button
                                        name="action_back_line"
                                        type="object"
                                        class="btn btn-primary pull-left btn-sm"
                                        context="{'wiz_barcode_id': parent.id}"
                                        accesskey="1"
                                    >
                                        <i
                                            class="fa fa-step-backward"
                                            title="Previous"
                                        />
                                    </button>
                                </div>
                                <div class="col-3">
                                    <button
                                        name="action_reset_lines"
                                        type="object"
                                        class="btn btn-warning pull-right btn-sm"
                                        context="{'wiz_barcode_id': parent.id}"
                                        accesskey="2"
                                    >
                                        <i class="fa fa-trash" title="Clean" />
                                    </button>
                                </div>
                                <div class="col-3">
                                    <button
                                        name="action_todo_next"
                                        type="object"
                                        class="btn btn-danger pull-right btn-sm"
                                        context="{'wiz_barcode_id': parent.id}"
                                        accesskey="3"
                                    >
                                    Done
                                    </button>
                                </div>
                                <div class="col-3">
                                    <button
                                        name="action_next_line"
                                        type="object"
                                        class="btn btn-primary pull-right btn-sm"
                                        context="{'wiz_barcode_id': parent.id}"
                                        accesskey="4"
                                    >
                                        <i class="fa fa-step-forward" title="Next" />
                                    </button>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Version of the kanban for multiple records -->
    <record id="view_stock_barcodes_todo_kanban_multi" model="ir.ui.view">
        <field name="name">stock.barcodes.todo.kanban</field>
        <field name="model">wiz.stock.barcodes.read.todo</field>
        <field name="priority">90</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" create="0">
                <field name="picking_code" />
                <field name="location_id" />
                <field name="location_name" />
                <field name="location_dest_id" />
                <field name="location_dest_name" />
                <field name="product_id" />
                <field name="lot_id" />
                <field name="uom_id" />
                <field name="package_id" />
                <field name="result_package_id" />
                <field name="package_product_qty" />
                <field name="product_uom_qty" />
                <field name="qty_done" />
                <field name="line_ids" invisible="1" />
                <field name="state" />
                <templates>
                    <t t-name="kanban-box">
                        <div
                            t-attf-class="oe_kanban_content "
                            style="background-color: #FFF8DC; width: 100%;"
                        >
                            <div class="row">
                                <div class="col-3">
                                        <div class="row">
                                            <div class="col">
                                                <span
                                                class="fa fa-map-marker"
                                                title="Location name"
                                            />
                                                <strong>
                                                    <span
                                                    attrs="{'invisible': [('picking_code', '!=', 'incoming')]}"
                                                >
                                                        <field
                                                        name="location_dest_name"
                                                    />
                                                    </span>
                                                    <span
                                                    attrs="{'invisible': [('picking_code', '!=', 'internal')]}"
                                                >
                                                        <field
                                                        name="location_name"
                                                    /> \u21E8 <field
                                                        name="location_dest_name"
                                                    />
                                                    </span>
                                                    <span
                                                    attrs="{'invisible': [('picking_code', '!=', 'outgoing')]}"
                                                >
                                                        <field name="location_name" />
                                                    </span>
                                                </strong>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                                <strong>
                                                    <field name="product_id" />
                                                </strong>
                                            </div>
                                        </div>
                                        <t
                                        t-if="record.lot_id or record.package_id or record.result_package_id"
                                    >
                                            <table>
                                                <tr>
                                                    <td>
                                                        <span>
                                                            <span
                                                            class="fa fa-tags"
                                                            title="Lot S/N"
                                                        />
                                                            <field name="lot_id" />
                                                        </span>
                                                    </td>
                                                    <td class="text-right">
                                                        <span class="fa fa-dropbox" />
                                                        <span>
                                                            <field name="package_id" />
                                                            <t
                                                            t-if="record.package_id"
                                                        >(<span
                                                                t-esc="record.package_product_qty.value"
                                                            /> <t
                                                                t-esc="record.uom_id.value.slice(0,3)"
                                                            />)</t>
                                                        </span>
                                                        <span>
                                                            <field
                                                            name="result_package_id"
                                                        />
                                                        </span>
                                                    </td>
                                                </tr>
                                            </table>
                                        </t>
                                        <div class="row">
                                            <div class="col-12">
                                                <span>
                                                    <span class="font-weight-bold">
                                                        <t
                                                        t-esc="record.qty_done.value"
                                                    />
                                                    </span> / <t
                                                    t-esc="record.product_uom_qty.value"
                                                /> <t
                                                    t-esc="record.uom_id.value.slice(0,3)"
                                                />
                                                </span>
                                            </div>
                                        </div>
                                </div>
                                <div class="col-9 font-weight-bold" name="controls">
                                    <div
                                        class="row align-items-center justify-content-end text-center h-100"
                                    >
                                        <div
                                            class="col-1 m-2 p-2"
                                            style="background-color: #5AC4f6;"
                                        >
                                            <button
                                                name="action_qty_done_minus_one"
                                                type="object"
                                                class="btn w-100 h-100"
                                            >
                                                <span class="fa fa-minus" />
                                            </button>
                                        </div>
                                        <div
                                            class="col-3 m-2 p-4"
                                            style="background-color: #5AC4f6;"
                                        >
                                            <t t-esc="record.qty_done.value" />
                                        </div>
                                        <div
                                            class="col-1 m-2 p-2"
                                            style="background-color: #5AC4f6;"
                                        >
                                            <button
                                                name="action_qty_done_plus_one"
                                                type="object"
                                                class="btn w-100 h-100"
                                            >
                                                <span class="fa fa-plus" />
                                            </button>
                                        </div>
                                        <div
                                            class="col-3 m-2 p-4"
                                            style="background-color: #5AC4f6;"
                                        >
                                            <button
                                                name="action_qty_done_fill"
                                                type="object"
                                                class="btn w-100 h-100"
                                            >
                                                Fill
                                            </button>
                                        </div>
                                        <div class="col-1" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="view_stock_barcodes_todo_kanban_embed" model="ir.ui.view">
        <field name="name">stock.barcodes.todo.kanban.embed</field>
        <field name="model">wiz.stock.barcodes.read.todo</field>
        <field name="priority">100</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="state" />
                <field name="product_id" />
                <field name="product_uom_qty" />
                <field name="qty_done" />
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card">
                            <div class="row">
                                <div class="col-6">
                                    <strong>
                                        <span>
                                            <field name="product_id" />
                                        </span>
                                    </strong>
                                </div>
                                <div class="col-2">
                                    <span class="pull-right text-right text-muted">
                                        <field name="product_uom_qty" />
                                    </span>
                                </div>
                                <div class="col-2">
                                    <span
                                        class="pull-right text-right"
                                        t-att-class="qty_done >= product_uom_qty ? 'text-success' : ''"
                                    >
                                        <field name="qty_done" />
                                    </span>
                                </div>
                                <div class="col-2 text-right">
                                    <button
                                        name="fill_from_pending_line"
                                        type="object"
                                        class="btn"
                                        context="{'wiz_barcode_id': parent.id}"
                                    >
                                        <i
                                            class="fa fa-upload"
                                            title="Fill from pencil"
                                            style="font-size:1.5em"
                                        />
                                    </button>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="view_stock_barcodes_todo_tree_embed" model="ir.ui.view">
        <field name="name">stock.barcodes.todo.tree</field>
        <field name="model">wiz.stock.barcodes.read.todo</field>
        <field name="priority">100</field>
        <field name="arch" type="xml">
            <tree>
                <field name="state" invisible="1" />
                <field name="product_id" />
                <field name="product_uom_qty" />
                <field name="line_ids" invisible="1" />
                <field
                    name="lot_id"
                    groups="stock.group_production_lot"
                    optional="hide"
                />
                <field
                    name="package_id"
                    groups="stock.group_tracking_lot"
                    optional="hide"
                />
                <field name="qty_done" />
                <button
                    name="fill_from_pending_line"
                    type="object"
                    class="btn"
                    icon="fa-upload"
                    context="{'wiz_barcode_id': parent.id}"
                />
            </tree>
        </field>
    </record>
</odoo>
