<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_stock_barcodes_read_picking_form" model="ir.ui.view">
        <field name="name">stock.barcodes.read.picking.form</field>
        <field name="model">wiz.stock.barcodes.read.picking</field>
        <field name="inherit_id" ref="stock_barcodes.view_stock_barcodes_read_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='manual_entry']/.." position="before">
                <field name="candidate_picking_ids" mode="kanban" attrs="{'invisible': [('candidate_picking_ids', '=', [])]}" nolabel="1">
                    <kanban>
                        <field name="name"/>
                        <field name="partner_id"/>
                        <field name="date"/>
                        <field name="state"/>
                        <field name="picking_id"/>
                        <field name="wiz_picking_id"/>
                        <templates>
                            <t t-name="kanban-box">
                                <div class="oe_kanban_color_alert oe_kanban_global_click">
                                    <div>
                                        <a name="action_lock_picking" type="object"
                                           t-if="record.picking_id.raw_value != record.wiz_picking_id.raw_value"
                                           class="fa fa-thumb-tack fa-2x pull-right"
                                           context="{'wiz_read_scan_id': parent.id}"
                                        />
                                        <a name="action_unlock_picking" type="object"
                                           class="fa fa-times fa-2x pull-right"
                                           t-if="record.picking_id.raw_value == record.wiz_picking_id.raw_value"
                                           context="{'wiz_read_scan_id': parent.id}"/>
                                    </div>
                                    <div>
                                    </div>
                                    <div class="oe_kanban_details">
                                        <div>
                                            <strong>
                                                <field name="name"/>
                                            </strong>
                                            <field name="date"/>
                                        </div>
                                        <div>
                                            <field name="partner_id"/>
                                        </div>
                                        <div>
                                            <a name="action_validate_picking" type="object"
                                               class="pull-right"
                                               attrs="{'invisible': [('state', 'not in', 'assigned')]}"
                                               context="{'wiz_read_scan_id': parent.id}">Validate</a>
                                        </div>
                                    </div>
                                </div>
                            </t>
                        </templates>
                    </kanban>
                </field>
            </xpath>
            <field name="location_id" position="before">
                <field name="picking_id"/>
            </field>
            <field name="product_qty" position="after">
                <field name="picking_product_qty"/>
            </field>
        </field>
    </record>

    <!--
     Open wizard in current target option to avoid that the wizard is
     closed after any button click,
    -->
    <record model="ir.actions.act_window" id="action_stock_barcodes_read_picking">
        <field name="res_model">wiz.stock.barcodes.read.picking</field>
        <field name="name">Barcodes Read</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="context">{}</field>
        <field name="view_id" ref="view_stock_barcodes_read_picking_form"/>
        <field name="target">current</field>
    </record>

</odoo>
